#Rewrite HTTP to HTTPS, Indexing OFF, Lets Encrypt SSL Support
#Place above all other .htaccess code in domain root

# Ensure RewriteEngine is on or enabled and remove directory indexes.
RewriteEngine On
Options -Indexes

#Allows direct requests to .well-known folder for Lets Encrypt
RewriteRule ^(\.well-known)($|\/) - [L]

# Check condition if using a reverse proxy.
RewriteCond %{HTTP:X-Forwarded-Proto} !https
# Check condition if HTTPS is off or false.
RewriteCond %{HTTPS} off
# Rewrite to HTTPS. If www. is missing the subsequent rule will catch it.
RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
# Rewrite to use www. if missing. [NC] is a case-insensitive match
RewriteCond %{HTTP_HOST} !^www\. [NC]
RewriteRule ^(.*)$ https://www.%{HTTP_HOST}%{REQUEST_URI} [L,R=301]